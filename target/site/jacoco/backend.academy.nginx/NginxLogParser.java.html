<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NginxLogParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">java</a> &gt; <a href="index.source.html" class="el_package">backend.academy.nginx</a> &gt; <span class="el_source">NginxLogParser.java</span></div><h1>NginxLogParser.java</h1><pre class="source lang-java linenums">package backend.academy.nginx;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import static backend.academy.config.ErrorMessages.INVALID_FORMAT_NGINX;

public class NginxLogParser {
    private static final String IP_ADDRESS_GROUP = &quot;ipAddress&quot;;
    private static final String TIMESTAMP_GROUP = &quot;timestamp&quot;;
    private static final String REQUEST_METHOD_GROUP = &quot;requestMethod&quot;;
    private static final String RESOURCE_GROUP = &quot;resource&quot;;
    private static final String HTTP_VERSION_GROUP = &quot;httpVersion&quot;;
    private static final String STATUS_CODE_GROUP = &quot;statusCode&quot;;
    private static final String RESPONSE_SIZE_GROUP = &quot;responseSize&quot;;
    private static final String NGINX_LOG_PATTERN =
        &quot;^(?&lt;ipAddress&gt;\\S+) - - \\[(?&lt;timestamp&gt;[^]]+)] \&quot;(?&lt;requestMethod&gt;\\S+) (?&lt;resource&gt;\\S+) &quot;
            + &quot;(?&lt;httpVersion&gt;\\S+)\&quot; (?&lt;statusCode&gt;\\d+) (?&lt;responseSize&gt;\\d+) \&quot;(?&lt;referer&gt;.*)\&quot; &quot;
            + &quot;\&quot;(?&lt;userAgent&gt;.*)\&quot;&quot;;

    private NginxLogParser() {
    }

    public static NginxLog parseLogLine(String line) {
<span class="fc" id="L24">        Pattern pattern = Pattern.compile(NGINX_LOG_PATTERN);</span>
<span class="fc" id="L25">        Matcher matcher = pattern.matcher(line);</span>

<span class="fc bfc" id="L27" title="All 2 branches covered.">        if (matcher.matches()) {</span>
<span class="fc" id="L28">            String ipAddress = matcher.group(IP_ADDRESS_GROUP);</span>
<span class="fc" id="L29">            String timestamp = matcher.group(TIMESTAMP_GROUP);</span>
<span class="fc" id="L30">            String requestMethod = matcher.group(REQUEST_METHOD_GROUP);</span>
<span class="fc" id="L31">            String resource = matcher.group(RESOURCE_GROUP);</span>
<span class="fc" id="L32">            String httpVersion = matcher.group(HTTP_VERSION_GROUP);</span>
<span class="fc" id="L33">            int statusCode = Integer.parseInt(matcher.group(STATUS_CODE_GROUP));</span>
<span class="fc" id="L34">            int responseSize = Integer.parseInt(matcher.group(RESPONSE_SIZE_GROUP));</span>

<span class="fc" id="L36">            return new NginxLog(ipAddress, &quot;-&quot;, &quot;-&quot;, timestamp, requestMethod, resource, httpVersion, statusCode,</span>
                responseSize);
        } else {
<span class="fc" id="L39">            throw new IllegalArgumentException(INVALID_FORMAT_NGINX);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>